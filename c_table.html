<!DOCTYPE HTML>

<html class="no-js">
<head>
	<!-- Basic Page Needs
	  ================================================== -->
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Troove.ca - rapide, précis, efficace</title>
	<meta name="description" content="">
	<meta name="keywords" content="">
	<meta name="author" content="Neuronex inc / KB">

	<!-- Mobile Specific Metas
	  ================================================== -->
	<meta name="viewport" content="width=device-width, user-scalable=0, initial-scale=1, minimum-scale=1, maximum-scale=1">
	<meta name="format-detection" content="telephone=yes">

	<link href="static/template/css/bootstrap.css" rel="stylesheet" type="text/css">
	<link href="static/template/css/bootstrap-theme.css" rel="stylesheet" type="text/css">
	<link href="static/template/css/style.css" rel="stylesheet" type="text/css">
	<!--<link href="static/template/vendor/prettyphoto/css/prettyPhoto.css" rel="stylesheet" type="text/css">-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettyPhoto/3.1.6/css/prettyPhoto.min.css" />
	<!--[if lte IE 9]><link rel="stylesheet" type="text/css" href="css/ie.css" media="screen" /><![endif]-->
	<link href="static/template/css/custom.css" rel="stylesheet" type="text/css">
	<link href="static/template/colors/color4.css" rel="stylesheet" type="text/css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.perfect-scrollbar/0.6.13/css/perfect-scrollbar.min.css" />

    <!-- datatables -->
    <link rel="stylesheet" type="text/css" href="https://www.doqtek.com/immo/CSS/dataTablesBootstrap.css" />
    <link rel="stylesheet" type="text/css" href="https://www.doqtek.com/immo/CSS/dataTables.scroller.css" />

    <style>
        .pace {
            -webkit-pointer-events: none;
            pointer-events: none;

            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        .pace-inactive {
            display: none;
        }

        .pace .pace-progress {
            background: #F23827;
            position: fixed;
            z-index: 2000;
            top: 0;
            right: 100%;
            width: 100%;
            height: 2px;
        }        
                
        div.DTS div.dataTables_scrollBody {
            background: white !important;
            background-color: white !important;
        }
        
        .table > tbody > tr > td { padding: 4px;}
        .table > thead > tr > th { border-bottom: 0;}
        .table > tbody > tr > th, .table > tbody > tr > td { border-top: 0;}        
        
        #t_cars_filter {
            display:none !important
        }
        
        #t_cars_info{
            text-align: right;
            color: silver
        }
        
        .results-list-view .result-item {
            margin-bottom: 2px;
        }        

        .table-img{
            z-index: -1;
            position: absolute;
            width:100%
        }
        
        #t_cars_processing { color: #F23827; padding: 5px 0 5px 0; text-align:center; }

        .media-box{width: 285px; height: 193px;}
        .results-list-view .result-item-image {
            width: auto;
            position: relative;
        }

        .results-list-view .result-item-in {
            width: calc(100% - 285px);        
        }

        .result-item-block.col2 {
            width: 150px;
            float: right;
        }

        .result-item-block.col1 {
            width: calc(100% - 160px);
            margin-right: 0;
            max-height: 6em;
            overflow-y: hidden;
            text-overflow: ellipsis;                  
        }

        .truncate {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        @media only screen and (max-width: 992px){
            .result-item-block.col1 {
                display: inherit;
            }
            .results-list-view .result-item-in {
                min-height: 231px;
            }              
        }

        .ps-scrollbar-y-rail { z-index: 9 !important };

        p {white-space: normal;}
    </style>
    
	<script src="static/template/js/modernizr.js"></script>
    
</head>

<body>

    <div class="container-fluid">
        <div class="table-responsive">
            <table id="t_cars" class="table table-condensed">

                <tbody>

                </tbody>
                
            </table>
        </div>
    </div>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.0/jquery-ui.min.js"></script>
    
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=Intl.~locale.fr-CA,Intl.~locale.en-CA"></script>

    <!--<script src="static/template/vendor/prettyphoto/js/prettyphoto.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prettyPhoto/3.1.6/js/jquery.prettyPhoto.min.js"></script>

    <script src="static/template/js/bootstrap.js"></script>

    <!-- SLIMSCROLL -->
    <!--<script src="https://www.doqtek.com/immo/js/jquery.slimscroll.min.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.perfect-scrollbar/0.6.13/js/perfect-scrollbar.jquery.min.js"></script>

    <!-- javascript Datatables -->
    <script src="https://www.doqtek.com/immo/js/dataTablesJquery.js"></script>
    <script src="https://www.doqtek.com/immo/js/dataTablesBootstrap.js"></script>

    <!-- Activate responsiveness in the "child" page -->
    <script src="https://www.doqtek.com/immo/js/jquery.responsiveiframe.js"></script>
    <script>
        var ri = responsiveIframe();
        ri.allowResponsiveEmbedding();
    </script>


    <!-- ITEM TEMPLATE -->
        <script id="cartlistitem" type="text/template">
            <div class="result-item format-standard">
                <div class="result-item-image">
                    <a href="javascript:;" class="media-box" >
                        <img class="table-img" src="{{=it.imgsrc}}" alt="car image">
                        <span class="zoom" data-url="{{=it.imgsrc}}" data-titre="{{=it.titre}}" data-description="{{=it.description}}"><span class='icon'><i class='icon-plus'></i></span></span>
                    </a>
                    <span class="label label-success vehicle-age">{{=it.annee}}</span>
                    <span class="label label-warning premium-listing">{{=it.sticker}}</span>
                    <div class="result-item-view-buttons">
                        <a href="javascript:;" data-rel="prettyPhoto"><i class="fa fa-play"></i> Vidéos</a>
                        <a href="javascript:;"><i class="fa fa-plus"></i> Détails</a>
                    </div>
                </div>
                <div class="result-item-in">
                    <h4 class="result-item-title truncate"><a href="javascript:;" title="{{=it.titre}}">{{=it.titre}}</a></h4>
                    <div class="result-item-cont">
                        <div class="result-item-block col1 desc">
                            <p>{{=it.description}}</p>
                        </div>
                        <div class="result-item-block col2">
                            <div class="result-item-pricing">
                                <div class="price">{{=it.prix}}</div>
                            </div>
                            <div class="result-item-action-buttons">
                                <a href="javascript:;" class="btn btn-default btn-sm"><i class="fa fa-star-o"></i> Favoris</a>
                                <a href="javascript:;" class="btn btn-default btn-sm">Infos</a><br>
                                <a href="javascript:;" class="distance-calc"><i class="fa fa-map-marker"></i> Distance ?</a>
                            </div>
                        </div>
                    </div>
                    <div class="result-item-features">
                        <ul class="inline">
                            <li><i class="fa fa-caret-right"></i>{{=it.pubdate}}</li>
                            {{? it.km }}
                                <li><i class="fa fa-caret-right"></i>{{=it.km}} KM</li>
                            {{?}}
                            {{? it.typevendeur }}
                                <li><i class="fa fa-caret-right"></i>{{=it.typevendeur}}</li>
                            {{?}}                            
                            {{? it.rouesmotricestr && it.rouesmotricestr != 'Autre'}}
                                <li><i class="fa fa-caret-right"></i>{{=it.rouesmotricestr}}</li>
                            {{?}}
                            {{? it.carburant }}
                                <li><i class="fa fa-caret-right"></i>{{=it.carburant}}</li>
                            {{?}}
                            {{? it.cylindres > 2  && it.cylindres != 'Autre' }}
                                <li><i class="fa fa-caret-right"></i>{{=it.cylindres}} cylindres</li>
                            {{?}}
                            {{? it.carosserie && it.carosserie != 'Autre' }}
                                <li><i class="fa fa-caret-right"></i>{{=it.carosserie}}</li>
                            {{?}}
                            {{? it.portes > 0}}
                                <li><i class="fa fa-caret-right"></i>{{=it.portes}} portes</li>
                            {{?}}
                            {{? it.places > 0}}
                                <li><i class="fa fa-caret-right"></i>{{=it.places}} places</li>
                            {{?}}
                            {{? it.couleurext}}
                                <li><i class="fa fa-caret-right"></i>{{=it.couleurext}}</li>
                            {{?}}
                            {{? it.transmission && it.transmission != 'Autre' }}
                                <li><i class="fa fa-caret-right"></i>{{=it.transmission}}</li>
                            {{?}}
                            {{? it.garniture}}
                                <li><i class="fa fa-caret-right"></i>{{=it.garniture}}</li>
                            {{?}}                                                                                                                                                                                                                                    
                        </ul>
                    </div>
                </div>
            </div>
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/dot/1.1.0/doT.js"></script>
    <!-- // ITEM TEMPLATE -->

    <!-- PACE AJAX PROGRESS BAR -->
        <script type="text/javascript">
        paceOptions = {
            restartOnRequestAfter: 500,
            restartOnPushState: true,
            minTime: 100,
            ajax: true,
            document: true,
            eventLag: true
        }
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <!-- // PACE AJAX PROGRESS BAR -->

    <script>
        var tempFn = doT.template( $("#cartlistitem").html() );

        // currency formatter.
        var dollar = new Intl.NumberFormat('fr-CA', {
            style: 'currency',
            currency: 'CAD',
            minimumFractionDigits: 0,
        });

        // km formatter.
        var bignumber = new Intl.NumberFormat('fr-CA', {
            style: 'decimal',
            useGrouping: true,
            minimumFractionDigits: 0,
        });

        // date courte formatter.
        var shortDate = new Intl.DateTimeFormat('fr-CA', {
            year: "numeric", 
            month: "long", 
            day: "numeric"
        });        

        $.urlParam = function(name){
            var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
            if (results==null){ return null; }
            else{ return results[1] || 0;}
        }

        function isOverflowed(element){
            return element.scrollHeight > element.clientHeight;
        }
        
        function rowrender(aData,nRow){
            //console.log(aData);
            // ASSIGNATIONS:
                //00 uid            : 37541
                //01 srcPicLink     : "http://i.ebayimg.com/00/s/NDUwWDgwMA==/z/sGUAAOSwuAVWvOga/$_35.JPG"
                //02 srcLink        : "http://www.kijiji.ca/v-autos-camions/ville-de-montreal/2008-honda-civic-sedan/1139613452"
                //03 Manufacturier  : "Honda"
                //04 Modele         : "Civic"
                //05 Garniture      : ""
                //06 Prix           : "6 000 $"
                //07 Annee          : "2008"
                //08 KM             : "133000"
                //09 Transmission   : "Automatique"
                //10 CouleurExt     : "Havane"
                //11 CouleurInt     : ""
                //12 Places         : "5"
                //13 Portes         : "4"
                //14 CarProof       : "0"
                //15 CarProofLink   : ""
                //16 Carburant      : "Essence"
                //17 Cylindres      : "-1"
                //18 Accident       : "-1"
                //19 Echange        : "-1"
                //20 Ville          : "2125 Rue de l'Église, Verdun, QC"
                //21 Region         : ""
                //22 RouesMotrice   : "-1"
                //23 RouesMotriceStr: "Roues motrices avant"
                //24 VendeurNom     : ""
                //25 VendeurTel     : ""
                //26 TypeVendeur    : "Propriétaire"
                //27 Carosserie     : "Berline"
                //28 title          : "2008 Honda Civic Sedan"
                //29 StockNo        : ""
                //30 description    : "This is a 4 cylinder car with automatic transmission and air conditioning. The body is in perfect condition and the car has passed the CAA inspection and is impeccable. For any inquiries you can&#8230;"
                //31 pubdate        : "{ts '2016-02-25 00:00:00'}"
                //32 srcPicLink0    : "http://i.ebayimg.com/00/s/NDUwWDgwMA==/z/ONcAAOSwG-1WvOgg/$_35.JPG"
                //33 srcPicLink1    : "http://i.ebayimg.com/00/s/NDUwWDgwMA==/z/OV4AAOSwG-1WvOgm/$_35.JPG"
                //34 srcPicLink2    : "http://i.ebayimg.com/00/s/NDUwWDgwMA==/z/okoAAOSwQYZWvOgq/$_35.JPG"
                //35 srcPicLink3    : "http://i.ebayimg.com/00/s/NDUwWDgwMA==/z/K~YAAOSwll1WvOgz/$_35.JPG"
                //36 srcPicLink4    : "http://i.ebayimg.com/00/s/NDUwWDgwMA==/z/O20AAOSwG-1WvOg4/$_35.JPG"
                //37 srcPicLink5    : "http://i.ebayimg.com/00/s/NDUwWDgwMA==/z/W7UAAOSwezVWvOg9/$_35.JPG"
                //38 srcPicLink6    : "https://placeholdit.imgix.net/~text?txtsize=33&txt=200%C3%97149&w=200&h=149"
                //39 srcPicLink7    : "https://placeholdit.imgix.net/~text?txtsize=33&txt=200%C3%97149&w=200&h=149"
                //40 srcPicLink8    : "https://placeholdit.imgix.net/~text?txtsize=33&txt=200%C3%97149&w=200&h=149"
                //41 srcPicLink9    : "https://placeholdit.imgix.net/~text?txtsize=33&txt=200%C3%97149&w=200&h=149"
                //42 pubdateepoch   :
            //

            return tempFn({
                imgsrc         : aData[1], //srcPicLink
                srclink        : aData[2],
                manufacturier  : aData[3],
                modele         : aData[4],
                garniture      : aData[5],
                prix           : dollar.format( aData[6] ),
                annee          : aData[7],
                km             : bignumber.format( aData[8] ),
                transmission   : aData[9],
                couleurext     : aData[10],
                couleurint     : aData[11],
                places         : aData[12],
                portes         : aData[13],
                carproof       : aData[14],
                carprooflink   : aData[15],
                carburant      : aData[16],
                cylindres      : aData[17],
                accident       : aData[18],
                echange        : aData[19],
                ville          : aData[20],
                region         : aData[21],
                rouesmotrice   : aData[22],
                rouesmotricestr: aData[23],
                vendeurnom     : aData[24],
                vendeurtel     : aData[25],
                typevendeur    : aData[26],
                carosserie     : aData[27],
                titre          : aData[28], //title
                stockno        : aData[29],
                description    : aData[30],
                pubdate        : shortDate.format( new Date(aData[42]*1000 ) ),
                sticker        : ""
            });
        }    
    </script>

    <script>
        $(document).ready(function()
        {
            $.fn.prettyPhoto({
                animation_speed: 'fast', /* fast/slow/normal */
                slideshow: 5000, /* false OR interval time in ms */
                autoplay_slideshow: false, /* true/false */
                opacity: 0.80, /* Value between 0 and 1 */
                show_title: true, /* true/false */
                allow_resize: true, /* Resize the photos bigger than viewport. true/false */
                default_width: 500,
                default_height: 344,
                counter_separator_label: '/', /* The separator for the gallery counter 1 "of" 2 */
                theme: 'pp_default', /* light_rounded / dark_rounded / light_square / dark_square / facebook /  pp_default*/
                horizontal_padding: 20, /* The padding on each side of the picture */
                hideflash: false, /* Hides all the flash object on a page, set to TRUE if flash appears over prettyPhoto */
                wmode: 'opaque', /* Set the flash wmode attribute */
                autoplay: true, /* Automatically start videos: True/False */
                modal: false, /* If set to true, only the close button will close the window */
                deeplinking: true, /* Allow prettyPhoto to update the url to enable deeplinking. */
                overlay_gallery: true, /* If set to true, a gallery will overlay the fullscreen image on mouse over */
                keyboard_shortcuts: true, /* Set to false if you open forms inside prettyPhoto */
                changepicturecallback: function(){}, /* Called everytime an item is shown/changed */
                callback: function(){}, /* Called when prettyPhoto is closed */
                ie6_fallback: true,
                social_tools: false
            });

            $(document).on('click', '.zoom', function(){ 
                $.prettyPhoto.open($( this ).data("url"),$( this ).data("titre"),$( this ).data("description"));
            });

            $height = $.urlParam('h'); //$(window).height() - 350;

            var oTable = $('#t_cars').dataTable({
                "bProcessing": true,
                "iDisplayLength": 20,
                "bLengthChange": false,
                "bServerSide": true,
                "sServerMethod": "POST", 
                "bDeferRender": true,
                "bAutoWidth": false,
                "bScrollInfinite": true,
                "bScrollCollapse": true,
                "oScroller": { "loadingIndicator": true }, 
                "sScrollY": $height - 77 + 'px',
                "iScrollLoadGap": 300,
                "sAjaxSource": "https://data.troove.ca/data.cfm",
                "sDom": "<'row-fluid'<'span5'<'toolbar'>><'span2'r><'span5 pull-right'f>>t<'row-fluid'<'span6'i><'span6'>>",
                "bDeferRender": true,
                "bStateSave": false,
                "fnServerParams": function(aoData) { aoData.push({ "name": "K", "value": "1" }); },
                "aoColumnDefs": [
                    {
                    "sName": "uid",
                    "bSortable": false,
                    "sWidth": "100%",
                    "sClass": "results-list-view",
                    "aTargets": [0]
                    }
                ],
                "oLanguage": {
                    "sProcessing": "chargement..",
                    "sLengthMenu": "_MENU_ lignes par page",
                    "sZeroRecords": "Aucune donn\xE9es",
                    "sInfo": "<var>_START_<\/var> \xE0 <var>_END_<\/var> sur <var>_TOTAL_<\/var> r\xE9sultats", //Lignes <var>_START_<\/var> \xE0 <var>_END_<\/var> sur <var>_TOTAL_<\/var> r\xE9sultats
                    "sInfoEmpty": "Aucune donn\xE9es",
                    "sInfoFiltered": "", //(filtr\xE9 \xE0 partir de <var>_MAX_<\/var> lignes totales)
                    "sSearch": "",
                    "oPaginate": {
                        "sFirst": "Premier",
                        "sPrevious": "Pr\xE9c\xE9dent",
                        "sNext": "Suivant",
                        "sLast": "Dernier"
                    }
                },
                "fnRowCallback": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) { 
                    $('td:eq(0)', nRow).html(rowrender(aData, nRow));
                    return nRow;
                },
                "fnDrawCallback": function(oSettings) {
                   $('.dataTables_scrollBody').perfectScrollbar('update');
                },
                "fnCreatedRow": function( nRow, aData, iDisplayIndex ) {
                    var el = $('.desc');
                    //console.log( isOverflowed(el) );
                    //console.log( el.scrollHeight ); 
                }                
            }); //dataTable

            // $(window).bind('resizeEnd', function()
            // {
            //     if (1 == 1)
            //     {
            //         /*$(".dataTables_scrollBody").height( $height - 50 );*/
            //         var NewHeight = $(window).height() - 350;
            //         var oSettings = oTable.fnSettings();
            //         oSettings.oScroll.sY = NewHeight + "px";
            //         oTable.fnDraw();
            //     }
            // });

            // $(window).resize(function() {
            //     if (this.resizeTO) { clearTimeout(this.resizeTO) };
            //     this.resizeTO = setTimeout(function() { $(this).trigger('resizeEnd'); }, 500);
            // });

            //$("div.toolbar").html(' ');

            $('.dataTables_scrollBody').css("position","relative");        
            $('.dataTables_scrollBody').perfectScrollbar({
                wheelSpeed: 1,
                minScrollbarLength: 30,
                suppressScrollX: false
            });//https://github.com/noraesae/perfect-scrollbar

            //$(window).bind('resize', function () { oTable.fnAdjustColumnSizing(); } );
        }); //$(document).ready
    </script>

</body>
</html>